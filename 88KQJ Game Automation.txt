package CrossbrowserTesting;

import java.io.IOException;
import java.time.Duration;
import java.util.ArrayList;
import java.util.List;
import java.util.NoSuchElementException;

import org.openqa.selenium.By;
import org.openqa.selenium.ElementClickInterceptedException;
import org.openqa.selenium.ElementNotInteractableException;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.StaleElementReferenceException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.interactions.MoveTargetOutOfBoundsException;
import org.openqa.selenium.support.ui.WebDriverWait;

public class finalGameTesting {
	public static void main(String[] args) throws InterruptedException, IOException {
		WebDriver driver = new ChromeDriver();
		driver.get("https://www.88kqj.com/en-th/");
		WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(40));
		driver.manage().window().maximize();
		Thread.sleep(1000);
		Actions actions = new Actions(driver);
		JavascriptExecutor jse = (JavascriptExecutor) driver;
		driver.findElement(By.xpath("//input[@placeholder='Enter Username']")).sendKeys("namobrigade");

		driver.findElement(By.xpath("//input[@class='topbar-input !pr-[50px]']")).sendKeys("chakravarthi123#");

		driver.findElement(By.xpath("//button[@class='topbar_btn_1 mr-[20px] hidden md:block']")).click();
		Thread.sleep(500);
		Thread.sleep(1000);
//		driver.findElement(By.xpath("//button[@class='mission_daily_close_btn']")).click();
		jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//a[text()=' Slot']")));
		driver.findElement(By.xpath("//a[text()=' Slot']")).click();
		Thread.sleep(500);
		actions.moveToElement(driver.findElement(By.xpath("//a[text()=' Home']"))).perform();
		Thread.sleep(1500);
		List<WebElement> SlotProviderNames = driver.findElements(By.xpath("//div[@class='tab_btn_text text-center text-xs mt-2 uppercase']"));
		for (int K = 1; K < 8; K++) {
			int ProvGamePassed = 0;
			int ProvGameFailed = 0;
			try {				
				WebElement slotprovider = SlotProviderNames.get(K);
				actions.moveToElement(slotprovider).perform();
				String SlotProviderName = slotprovider.getText();
				System.out.println("The Provider Name Is: " + SlotProviderName);
				slotprovider.click();
				Thread.sleep(100);
			} catch (StaleElementReferenceException e) {
				jse.executeScript("window.scrollBy(200,0)");
				Thread.sleep(100);
				SlotProviderNames = driver
						.findElements(By.xpath("//div[@class='tab_btn_text text-center text-xs mt-2 uppercase']"));
				WebElement slotprovider = SlotProviderNames.get(K);
				String SlotProviderName = slotprovider.getText();
				System.out.println("The Provider Name Is: " + SlotProviderName);
				slotprovider.click();
				Thread.sleep(100);
			} catch (MoveTargetOutOfBoundsException e) {
				jse.executeScript("window.scrollBy(200,0)");
				Thread.sleep(50);
				continue;
			}
			List<WebElement> pages = driver.findElements(By.xpath("//button[@class='p-btn']"));
			String CurrentUrl = driver.getCurrentUrl();
			int count2 = 0;
			
			if( driver.findElements(By.xpath("//button[@class='p-btn']")).size()!=0) {
				pages = driver.findElements(By.xpath("//button[@class='p-btn']"));
				int lastIndex = pages.size() - 1;
				WebElement lastElement = pages.get(lastIndex);
				String count1 = lastElement.getText();
				count2 = Integer.parseInt(count1);
				System.out.println("Pages: "+pages.size());
			}
			else {
				count2 = 1;
			}
			for (int jc = 1; jc <= count2; jc++) {
				if (jc > 5 && jc < 8) {
					actions.scrollByAmount(1450, 1450).perform();
					Thread.sleep(950);
					WebElement hid = driver.findElement(By.xpath("//button[text()='5']"));
					jse.executeScript("arguments[0].click()", hid);
					List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
					WebElement button = PageButton2.get(jc);
					String buttonText = button.getText();
					System.out.println("buttonText: "+buttonText);
					jse.executeScript("arguments[0].click()", button);
					Thread.sleep(1050);
					actions.scrollByAmount(-1450, -1450).perform();
					Thread.sleep(950);
				}else if(jc>=8) {
					actions.scrollByAmount(1450, 1450).perform();
					Thread.sleep(950);
					driver.findElement(By.xpath("//button[text()='1']")).click();
					Thread.sleep(2500);
					jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='5']")));
					Thread.sleep(2500);
					jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='7']")));
					Thread.sleep(2500);
					if(jc>=9) {
						driver.findElement(By.xpath("//button[text()='8']")).click();
						Thread.sleep(2500);
						Thread.sleep(2500);
						try {
							List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
							WebElement button = PageButton2.get(jc);
							String buttonText = button.getText();
							System.out.println("buttonText: "+buttonText);
							jse.executeScript("arguments[0].click()", button);
							Thread.sleep(1050);
						}catch(IndexOutOfBoundsException e) {
							if(jc<=12) {
								WebElement button = driver.findElement(By.xpath("//button[text()="+jc+"]"));
								String buttonText = button.getText();
								System.out.println("buttonText: "+buttonText);
								jse.executeScript("arguments[0].click()", button);
								Thread.sleep(1050);
							}else {
								break;
							}
						}
					}else {
						List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
						WebElement button = PageButton2.get(jc);
						String buttonText = button.getText();
						System.out.println("buttonText: "+buttonText);
						jse.executeScript("arguments[0].click()", button);
						Thread.sleep(1050);
					}
					actions.scrollByAmount(-1450, -1450).perform();
					Thread.sleep(950);
				}
				else if (jc == 1) {
				} 
				else {
					actions.scrollByAmount(1450, 1450).perform();
					Thread.sleep(950);
					List<WebElement> PageButton = driver.findElements(By.xpath(
							"//div[@class='flex justify-center items-center']/descendant::button"));
					WebElement button = PageButton.get(jc);
					String buttonName = button.getText();
					System.out.println("Page Number Is: "+buttonName);
					jse.executeScript("arguments[0].click()", button);
					actions.scrollByAmount(-1450, -1450).perform();
					Thread.sleep(950);
				}
			//--------------------------------------------------------------------------------------------------------------------------------------//
			// Game Section 
			//--------------------------------------------------------------------------------------------------------------------------------------//
		    	List<WebElement> gamesButton = driver.findElements(By.xpath("//div[@class='game_btn_content']//button"));
		    	List<WebElement> TestCmt = driver.findElements(By.xpath("//div[@class='game_btn_content']//div[@class='game_btn_content_text']"));
				for(int g=gamesButton.size()-5;g<gamesButton.size();g++) {
		  			for(;;) {
		  	        	try {
		  	        		TestCmt = driver.findElements(By.xpath("//div[@class='game_btn_content']//div[@class='game_btn_content_text']"));
		  	        		gamesButton = driver.findElements(By.xpath("//div[@class='game_btn_content']//button"));
		  	        		WebElement GameName = TestCmt.get(g);
		  	        		String GameNameIs = GameName.getText();
		  	        		WebElement GameButton = gamesButton.get(g);
//		  	        		if (GameName.isDisplayed()) {
//		  	        			boolean doesItMatch = GameNameIs.matches(
//										"[A-Z]([A-Z0-9][a-z][a-z0-9][A-Z]|[a-z0-9][A-Z][A-Z0-9][a-z])[A-Za-z0-9]*");
//								boolean doesItMatch2 = GameNameIs.matches("\b[A-Z]+\b");
//								if (doesItMatch) {
//									System.out.println("****the game name is not having space :" + GameNameIs);
//								} else if (doesItMatch2) {
//									System.out.println(
//											"*****the game name contains only capital letter :" + GameNameIs);
//								}
		  	        		if (GameButton.isEnabled()) {
		  	        			actions.moveToElement(GameButton).perform();
								jse.executeScript("arguments[0].click()", GameButton);
		  	        			String FinalUrl = driver.getCurrentUrl();
		                    	 ArrayList<String> tabs = new ArrayList<>(driver.getWindowHandles());
			                        int countw = tabs.size();
			                        if (countw > 1) {
			                            driver.switchTo().window(tabs.get(1));
			                            Thread.sleep(2500);
			                            System.out.println("Pass: " + GameNameIs + " is working fine");
			                            driver.close();
			                            driver.switchTo().window(tabs.get(0));
			                            Thread.sleep(1800);
			                            actions.scrollByAmount(0, -300).perform();
			                            System.out.println("Pass: " + GameNameIs + " is working fine");
			                            if(g<gamesButton.size()) {
			                            	if (jc > 5 && jc < 8) {
			        	    					actions.scrollByAmount(1450, 1450).perform();
			        	    					Thread.sleep(950);
			        							WebElement hid = driver.findElement(By.xpath("//button[text()='5']"));
			        							jse.executeScript("arguments[0].click()", hid);
			        							List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			        							WebElement button = PageButton2.get(jc);
			        							jse.executeScript("arguments[0].click()", button);
			        							Thread.sleep(1050);
			        							actions.scrollByAmount(-1450, -1450).perform();
			        							Thread.sleep(950);
			        	    				}else if(jc>=8) {
			        							actions.scrollByAmount(1450, 1450).perform();
			        	    					Thread.sleep(950);
			        	    					driver.findElement(By.xpath("//button[text()='1']")).click();
			        	    					Thread.sleep(2500);
			        							jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='5']")));
			        							Thread.sleep(2500);
			        							jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='7']")));
			        							Thread.sleep(2500);
			        							if(jc>=9) {
			        								driver.findElement(By.xpath("//button[text()='8']")).click();
			        								Thread.sleep(2500);
			        								Thread.sleep(2500);
			        								try {
			        									List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			        									WebElement button = PageButton2.get(jc);
			        									jse.executeScript("arguments[0].click()", button);
			        									Thread.sleep(1050);
			        								}catch(IndexOutOfBoundsException e) {
			        									if(jc<=12) {
			        										WebElement button = driver.findElement(By.xpath("//button[text()="+jc+"]"));
			        										jse.executeScript("arguments[0].click()", button);
			        										Thread.sleep(1050);
			        									}else {
			        										break;
			        									}
			        								}
			        							}else {
			        								List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			        								WebElement button = PageButton2.get(jc);
			        								jse.executeScript("arguments[0].click()", button);
			        								Thread.sleep(1050);
			        							}
			        							actions.scrollByAmount(-1450, -1450).perform();
			        							Thread.sleep(950);
			        						}
			        	    				else if (jc == 1) {
			        						} 
			        						else {
			        							actions.scrollByAmount(1450, 1450).perform();
			        	    					Thread.sleep(950);
			        							List<WebElement> PageButton = driver.findElements(By.xpath(
			        									"//div[@class='flex justify-center items-center']/descendant::button"));
			        							WebElement button = PageButton.get(jc);
			        							jse.executeScript("arguments[0].click()", button);
			        							actions.scrollByAmount(-1450, -1450).perform();
			        	    					Thread.sleep(950);
			        						}
			                            }
			                        }else 
//			                        	if (CurrentUrl.equals(FinalUrl)) {
			                        	if (driver.findElements(By.xpath("//div[@class='toast-message text-sm']")).size() != 0) {
			                        		String messgtext = (driver
													.findElement(By.xpath("//div[@class='toast-message text-sm']")))
													.getText();
											driver.findElement(By.xpath(
													"//div[@class='toast-close ml-2 flex items-center self-center']"))
													.click();
											System.out.println(
													"Fail: " + GameNameIs + " Is Not Opening: Message:- " + messgtext);
											ProvGameFailed++;
			                            	if(g<gamesButton.size()) {
			                            		if (jc > 5 && jc < 8) {
			            	    					actions.scrollByAmount(1450, 1450).perform();
			            	    					Thread.sleep(950);
			            							WebElement hid = driver.findElement(By.xpath("//button[text()='5']"));
			            							jse.executeScript("arguments[0].click()", hid);
			            							List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			            							WebElement button = PageButton2.get(jc);
			            							jse.executeScript("arguments[0].click()", button);
			            							Thread.sleep(1050);
			            							actions.scrollByAmount(-1450, -1450).perform();
			            							Thread.sleep(950);
			            	    				}else if(jc>=8) {
			            							actions.scrollByAmount(1450, 1450).perform();
			            	    					Thread.sleep(950);
			            	    					driver.findElement(By.xpath("//button[text()='1']")).click();
			            	    					Thread.sleep(2500);
			            							jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='5']")));
			            							Thread.sleep(2500);
			            							jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='7']")));
			            							Thread.sleep(2500);
			            							if(jc>=9) {
			            								driver.findElement(By.xpath("//button[text()='8']")).click();
			            								Thread.sleep(2500);
			            								Thread.sleep(2500);
			            								try {
			            									List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			            									WebElement button = PageButton2.get(jc);
			            									jse.executeScript("arguments[0].click()", button);
			            									Thread.sleep(1050);
			            								}catch(IndexOutOfBoundsException e) {
			            									if(jc<=12) {
			            										WebElement button = driver.findElement(By.xpath("//button[text()="+jc+"]"));
			            										jse.executeScript("arguments[0].click()", button);
			            										Thread.sleep(1050);
			            									}else {
			            										break;
			            									}
			            								}
			            							}else {
			            								List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
			            								WebElement button = PageButton2.get(jc);
			            								jse.executeScript("arguments[0].click()", button);
			            								Thread.sleep(1050);
			            							}
			            							actions.scrollByAmount(-1450, -1450).perform();
			            							Thread.sleep(950);
			            						}
			            	    				else if (jc == 1) {
			            						} 
			            						else {
			            							actions.scrollByAmount(1450, 1450).perform();
			            	    					Thread.sleep(950);
			            							List<WebElement> PageButton = driver.findElements(By.xpath(
			            									"//div[@class='flex justify-center items-center']/descendant::button"));
			            							WebElement button = PageButton.get(jc);
			            							jse.executeScript("arguments[0].click()", button);
			            							actions.scrollByAmount(-1450, -1450).perform();
			            	    					Thread.sleep(950);
			            						}
				                            }
		  	        			} else if(driver.findElements(By.xpath("//button[@TYPE='button']/*[@class='w-5 h-5 game_header_close_btn']")).size() != 0){
		  	        				ProvGamePassed++;
		  	        				System.out.println("Pass: " + GameNameIs + " Is Working Fine");
		  	        				Thread.sleep(2000);
									driver.findElement(By.xpath("//button[@TYPE='button']/*[@class='w-5 h-5 game_header_close_btn']")).click();
			  	        				if(g<gamesButton.size()) {
			  	        					if (jc > 5 && jc < 8) {
							  					actions.scrollByAmount(1450, 1450).perform();
							  					Thread.sleep(2000);
							  					WebElement hid = driver.findElement(By.xpath("//button[text()='5']"));
												jse.executeScript("arguments[0].click()", hid);
												List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
												WebElement button = PageButton2.get(jc);
												button.click();
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(2000);
							  				}else if(jc>=8) {
													actions.scrollByAmount(1450, 1450).perform();
							  					Thread.sleep(950);
							  					driver.findElement(By.xpath("//button[text()='1']")).click();
							  					Thread.sleep(2500);
													jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='5']")));
													Thread.sleep(2500);
													jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='7']")));
													Thread.sleep(2500);
													if(jc>=9) {
														driver.findElement(By.xpath("//button[text()='8']")).click();
														Thread.sleep(2500);
														Thread.sleep(2500);
														try {
															List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
															WebElement button = PageButton2.get(jc);
															jse.executeScript("arguments[0].click()", button);
															Thread.sleep(1050);
														}catch(IndexOutOfBoundsException e) {
															if(jc<=12) {
																WebElement button = driver.findElement(By.xpath("//button[text()="+jc+"]"));
																jse.executeScript("arguments[0].click()", button);
																Thread.sleep(1050);
															}else {
																break;
															}
														}
													}else {
														List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
														WebElement button = PageButton2.get(jc);
														jse.executeScript("arguments[0].click()", button);
														Thread.sleep(2000);
													}
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(950);
												}
							  				else if (jc == 1) {
												} 
												else {
													actions.scrollByAmount(1450, 1450).perform();
													Thread.sleep(2000);
													List<WebElement> PageButton = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
													WebElement button = PageButton.get(jc);
													button.click();
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(2000);
												}
			  	        				}
		  	        			}else {
		  	        				ProvGamePassed++;
		  	        				System.out.println("Pass: " + GameNameIs + " Is Working Fine");
		  	        				Thread.sleep(2000);
		  	        				driver.navigate().back();
		  	        				
			  	        				if(g<gamesButton.size()) {
			  	        					if (jc > 5 && jc < 8) {
							  					actions.scrollByAmount(1450, 1450).perform();
							  					Thread.sleep(2000);
							  					WebElement hid = driver.findElement(By.xpath("//button[text()='5']"));
												jse.executeScript("arguments[0].click()", hid);
												List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
												WebElement button = PageButton2.get(jc);
												button.click();
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(2000);
							  				}else if(jc>=8) {
													actions.scrollByAmount(1450, 1450).perform();
							  					Thread.sleep(950);
							  					driver.findElement(By.xpath("//button[text()='1']")).click();
							  					Thread.sleep(2500);
													jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='5']")));
													Thread.sleep(2500);
													jse.executeScript("arguments[0].click()", driver.findElement(By.xpath("//button[text()='7']")));
													Thread.sleep(2500);
													if(jc>=9) {
														driver.findElement(By.xpath("//button[text()='8']")).click();
														Thread.sleep(2500);
														Thread.sleep(2500);
														try {
															List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
															WebElement button = PageButton2.get(jc);
															String buttonText = button.getText();
															jse.executeScript("arguments[0].click()", button);
															Thread.sleep(1050);
														}catch(IndexOutOfBoundsException e) {
															if(jc<=12) {
																WebElement button = driver.findElement(By.xpath("//button[text()="+jc+"]"));
																String buttonText = button.getText();
																jse.executeScript("arguments[0].click()", button);
																Thread.sleep(1050);
															}else {
																break;
															}
														}
													}else {
														List<WebElement> PageButton2 = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
														WebElement button = PageButton2.get(jc);
														String buttonText = button.getText();
														jse.executeScript("arguments[0].click()", button);
														Thread.sleep(2000);
													}
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(950);
												}
							  				else if (jc == 1) {
												} 
												else {
													actions.scrollByAmount(1450, 1450).perform();
													Thread.sleep(2000);
													List<WebElement> PageButton = driver.findElements(By.xpath("//div[@class='flex justify-center items-center']/descendant::button"));
													WebElement button = PageButton.get(jc);
													button.click();
													actions.scrollByAmount(-1450, -1450).perform();
													Thread.sleep(2000);
												}
			  	        				}
		  	        			}
								}else {
									System.out.println("Fail: GameName Is Disabled: " + GameName);
								}
//		  	        		} else {
//		  	        			System.out.println("Fail: GameName Is Not Displayed: " + GameName);
//		  	        		}
		  	        		break;
		  	        	}catch(NoSuchElementException e) {
		  	        		jse.executeScript("window.scrollBy(0,150)");
		  	        		Thread.sleep(200);
		  	        		continue;
		  	        	}catch(MoveTargetOutOfBoundsException e) {
		  	        		jse.executeScript("window.scrollBy(0,150)");
		  	        		Thread.sleep(200);
		  	        	}catch(StaleElementReferenceException e) {
		  	        		jse.executeScript("window.scrollBy(0,150)");
		  	        		Thread.sleep(200);
		  	        		continue;
		  	        	}catch(IndexOutOfBoundsException e) {
		  	        		jse.executeScript("window.scrollBy(0,150)");;
		  	        		Thread.sleep(200);
		  	        	}
		  			}
		    	}
			}
			System.out.println("Total number of games Failed in Slot Provider: "+ProvGameFailed);
			System.out.println("Total number of games Failed in Slot Provider: "+ProvGamePassed);
		}
		driver.quit();
	}
}
